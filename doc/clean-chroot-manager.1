.\" Text automatically generated by txt2man
.TH clean-chroot-manager 1 "06 September 2013" "" ""
.SH NAME
\fBclean-chroot-manager (ccm) \fP- A wrapper script to manage clean chroots for building packages under Arch Linux.
\fB
.SH DESCRIPTION
Use this script as a "one-click" solution for building packages in a clean chroot. A key feature that provides both convenience and flexibility is the automatic management of a local pacman repo inside the chroot. This is helpful if building a package that has a dependency that also has to be built (i.e. one that is not available from the Arch repos).
.PP
An illustrative example, let's say that we want to build "bar" from the AUR. "Bar" has a build dependency of "foo" which is also in the AUR. Rather than first building "foo", then installing "foo", then building "bar", and finally removing "foo", the local repo will save a copy of foo.pkg.tar.xz which is indexed automatically therein. Pacman within the chroot is aware of the "foo" package thanks to the local repo. So, when the user tries to build "bar", pacman will silently grabs foo.pkg.tar.xz from the local repo as any other dependency.
.SH SYNOPSIS
.nf
.fam C
\fBsudo\fP \fIccm\fP [\fIoption\fP]

.fam T
.fi
.fam T
.fi
.SH OPTIONS
.TP
.B
c
Create a clean chroot.
.TP
.B
t
Toggle [testing] and [community-testing] on/off in the chroot. This function will enable or disable the testing repos in the chroot and also take care of upgrading/downgrading any affected packages.
.TP
.B
s
Run makepkg in build mode under the chroot. The equivalent of `makepkg \fB-src\fP` in the chroot.
.TP
.B
l
List the contents of the local repo (i.e. the packages built to date).
.TP
.B
n
Nuke the clean chroot (delete it and everything under it).
.TP
.B
p
Preview settings. Show some bits about the chroot itself.
.TP
.B
u
Update the packages inside the chroot. The equivalent of `pacman \fB-Syu\fP` in the chroot.
.SH QUICK SETUP
.IP 1. 4
Make sure the user has \fBsudo\fP rights to execute /usr/bin/clean-chroot-manager or /usr/bin/\fIccm\fP.
.IP 2. 4
Run the script to create $HOME/.config/clean-chroot-manager.conf wherein some options and settings are stored.
.IP 3. 4
Edit this file which is commented and self-explanatory.
.SH USAGE EXAMPLES
This will create a clean chroot under the path defined in the aforementioned config file:
.PP
.nf
.fam C
 $ sudo ccm c

.fam T
.fi
This will attempt to build the package in the clean chroot. If successful, the package will be added to a local pacman repo inside the chroot so that it will be available for use as a dependency for building other packages:
.PP
.nf
.fam C
 $ cd /path/to/PKGBUILD
 $ sudo ccm s

.fam T
.fi
This simply lists the contents of the chroot's local repo assuming something has been built. Useful to see what is present:
.PP
.nf
.fam C
 $ sudo ccm l

.fam T
.fi
This deletes everything under the top level of the chroot effectively removing it from the system.
.PP
.nf
.fam C
 $ sudo ccm n

.fam T
.fi
.SH TIPS
.IP \(bu 3
If your machine has lots of memory, consider locating the chroot to tmpfs to avoid disk usage/minimize access times.
.IP \(bu 3
Since \fIccm\fP requires \fBsudo\fP rights, consider making an alias for invoking it as such in your ~/.bashrc or the link. For example: alias \fIccm\fP='\fBsudo\fP \fIccm\fP'
.SH BUGS
No known bugs.
.SH AUTHOR
graysky (graysky AT archlinux DOT us).
